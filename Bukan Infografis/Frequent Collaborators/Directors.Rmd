---
title: "Frequent Collaborators In Movies"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
setwd("/cloud/project/Bukan Infografis/Frequent Collaborators")
```

Percaya atau tidak, dalam bekerja biasanya kita memilih rekan kerja yang memang kita nyaman bekerja dengannya. Hal ini berlaku untuk semua bidang pekerjaan. 

Sama saat para sutradara terbaik dunia dalam membuat film, ternyata ada beberapa aktor atau aktris yang menjadi __langganan__ mereka untuk bekerja sama.

Terinspirasi dari [__Six Degree of Kevin Bacon__](https://en.m.wikipedia.org/wiki/Six_Degrees_of_Kevin_Bacon), saya iseng akan membuat aktor atau aktris siapa yang memiliki koneksi kerjasama banyak dengan sutradara-sutradara tersebut.

Datanya akan saya scrap dari informasi detail yang tersedia di __Wikipedia__ yah.

Contohnya, pada film [Spider-Man: Far From Home](https://en.wikipedia.org/wiki/Spider-Man:_Far_From_Home), data hasil _scrap_-nya seperti ini:


```{r,include=FALSE}
rm(list=ls())
setwd("/cloud/project/Bukan Infografis/Frequent Collaborators")
library(rvest)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(ggraph)
library(igraph)
```

```{r,echo=FALSE}

url = 'https://en.wikipedia.org/wiki/Spider-Man:_Far_From_Home'

scrap = function(url){
  data = read_html(url) %>% 
    html_nodes(xpath = '//*[contains(concat( " ", @class, " " ), concat( " ", "vevent", " " ))]') %>%
    html_table(fill=T)
  data = data[[1]]
  judul = colnames(data)[1]
  colnames(data) = c('id','ket')
  
  sutradara = data %>% 
    filter(grepl('direct',id,ignore.case = T)) %>% 
    select(ket)
  sutradara = sutradara[1,]
  
  aktors = data %>% 
    filter(grepl('star',id,ignore.case = T)) %>% 
    select(ket)
  aktors = aktors[1,]
  aktors = strsplit(aktors,'\n')
  aktors = unlist(aktors)
  data = data.frame(judul,sutradara,aktors)
  return(data)
}

data = scrap(url)
data
```

Nah, kita akan _scrap_ data 10 film dengan _highest grossing_ dari tahun 2000 - 2019. Kita dapatkan data sebagai berikut:

```{r,echo=FALSE,warning=FALSE,message=FALSE}
urls = c('https://en.wikipedia.org/wiki/Avengers:_Endgame',
         'https://en.wikipedia.org/wiki/The_Lion_King_(2019_film)',
         'https://en.wikipedia.org/wiki/Frozen_II',
         'https://en.wikipedia.org/wiki/Captain_Marvel_(film)',
         'https://en.wikipedia.org/wiki/Toy_Story_4',
         'https://en.wikipedia.org/wiki/Joker_(2019_film)',
         'https://en.wikipedia.org/wiki/Aladdin_(2019_film)',
         'https://en.wikipedia.org/wiki/Star_Wars:_The_Rise_of_Skywalker',
         'https://en.wikipedia.org/wiki/Hobbs_%26_Shaw',
         'https://en.wikipedia.org/wiki/Avengers:_Infinity_War',
         'https://en.wikipedia.org/wiki/Black_Panther_(film)',
         'https://en.wikipedia.org/wiki/Jurassic_World:_Fallen_Kingdom',
         'https://en.wikipedia.org/wiki/Incredibles_2',
         'https://en.wikipedia.org/wiki/Aquaman_(film)',
         'https://en.wikipedia.org/wiki/Bohemian_Rhapsody_(film)',
         'https://en.wikipedia.org/wiki/Venom_(2018_film)',
         'https://en.wikipedia.org/wiki/Mission:_Impossible_%E2%80%93_Fallout',
         'https://en.wikipedia.org/wiki/Deadpool_2',
         'https://en.wikipedia.org/wiki/Fantastic_Beasts:_The_Crimes_of_Grindelwald',
         'https://en.wikipedia.org/wiki/Star_Wars:_The_Last_Jedi',
         'https://en.wikipedia.org/wiki/Beauty_and_the_Beast_(2017_film)',
         'https://en.wikipedia.org/wiki/The_Fate_of_the_Furious',
         'https://en.wikipedia.org/wiki/Despicable_Me_3',
         'https://en.wikipedia.org/wiki/Jumanji:_Welcome_to_the_Jungle',
         'https://en.wikipedia.org/wiki/Spider-Man:_Homecoming',
         'https://en.wikipedia.org/wiki/Wolf_Warrior_2',
         'https://en.wikipedia.org/wiki/Guardians_of_the_Galaxy_Vol._2',
         'https://en.wikipedia.org/wiki/Thor:_Ragnarok',
         'https://en.wikipedia.org/wiki/Wonder_Woman_(2017_film)',
         'https://en.wikipedia.org/wiki/Captain_America:_Civil_War',
         'https://en.wikipedia.org/wiki/Rogue_One',
         'https://en.wikipedia.org/wiki/Finding_Dory',
         'https://en.wikipedia.org/wiki/Zootopia',
         'https://en.wikipedia.org/wiki/The_Jungle_Book_(2016_film)',
         'https://en.wikipedia.org/wiki/The_Secret_Life_of_Pets',
         'https://en.wikipedia.org/wiki/Batman_v_Superman:_Dawn_of_Justice',
         'https://en.wikipedia.org/wiki/Fantastic_Beasts_and_Where_to_Find_Them_(film)',
         'https://en.wikipedia.org/wiki/Deadpool_(film)',
         'https://en.wikipedia.org/wiki/Suicide_Squad_(film)',
         'https://en.wikipedia.org/wiki/Star_Wars:_The_Force_Awakens',
         'https://en.wikipedia.org/wiki/Jurassic_World',
         'https://en.wikipedia.org/wiki/Furious_7',
         'https://en.wikipedia.org/wiki/Avengers:_Age_of_Ultron',
         'https://en.wikipedia.org/wiki/Minions_(film)',
         'https://en.wikipedia.org/wiki/Spectre_(2015_film)',
         'https://en.wikipedia.org/wiki/Inside_Out_(2015_film)',
         'https://en.wikipedia.org/wiki/Mission:_Impossible_%E2%80%93_Rogue_Nation',
         'https://en.wikipedia.org/wiki/The_Hunger_Games:_Mockingjay_%E2%80%93_Part_2',
         'https://en.wikipedia.org/wiki/The_Martian_(film)',
         'https://en.wikipedia.org/wiki/Transformers:_Age_of_Extinction',
         'https://en.wikipedia.org/wiki/The_Hobbit:_The_Battle_of_the_Five_Armies',
         'https://en.wikipedia.org/wiki/Guardians_of_the_Galaxy_(film)',
         'https://en.wikipedia.org/wiki/Maleficent_(film)',
         'https://en.wikipedia.org/wiki/The_Hunger_Games:_Mockingjay_%E2%80%93_Part_1',
         'https://en.wikipedia.org/wiki/X-Men:_Days_of_Future_Past',
         'https://en.wikipedia.org/wiki/Captain_America:_The_Winter_Soldier',
         'https://en.wikipedia.org/wiki/Dawn_of_the_Planet_of_the_Apes',
         'https://en.wikipedia.org/wiki/The_Amazing_Spider-Man_2',
         'https://en.wikipedia.org/wiki/Interstellar_(film)',
         'https://en.wikipedia.org/wiki/Frozen_(2013_film)',
         'https://en.wikipedia.org/wiki/Iron_Man_3',
         'https://en.wikipedia.org/wiki/Despicable_Me_2',
         'https://en.wikipedia.org/wiki/The_Hobbit:_The_Desolation_of_Smaug',
         'https://en.wikipedia.org/wiki/The_Hunger_Games:_Catching_Fire',
         'https://en.wikipedia.org/wiki/Fast_%26_Furious_6',
         'https://en.wikipedia.org/wiki/Monsters_University',
         'https://en.wikipedia.org/wiki/Gravity_(2013_film)',
         'https://en.wikipedia.org/wiki/Man_of_Steel_(film)',
         'https://en.wikipedia.org/wiki/Thor:_The_Dark_World',
         'https://en.wikipedia.org/wiki/The_Avengers_(2012_film)',
         'https://en.wikipedia.org/wiki/Skyfall',
         'https://en.wikipedia.org/wiki/The_Dark_Knight_Rises',
         'https://en.wikipedia.org/wiki/The_Hobbit:_An_Unexpected_Journey',
         'https://en.wikipedia.org/wiki/Ice_Age:_Continental_Drift',
         'https://en.wikipedia.org/wiki/The_Twilight_Saga:_Breaking_Dawn_%E2%80%93_Part_2',
         'https://en.wikipedia.org/wiki/The_Amazing_Spider-Man_(2012_film)',
         'https://en.wikipedia.org/wiki/Madagascar_3:_Europe%27s_Most_Wanted',
         'https://en.wikipedia.org/wiki/The_Hunger_Games_(film)',
         'https://en.wikipedia.org/wiki/Men_in_Black_3',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Deathly_Hallows_%E2%80%93_Part_2',
         'https://en.wikipedia.org/wiki/Transformers:_Dark_of_the_Moon',
         'https://en.wikipedia.org/wiki/Pirates_of_the_Caribbean:_On_Stranger_Tides',
         'https://en.wikipedia.org/wiki/The_Twilight_Saga:_Breaking_Dawn_%E2%80%93_Part_1',
         'https://en.wikipedia.org/wiki/Mission:_Impossible_%E2%80%93_Ghost_Protocol',
         'https://en.wikipedia.org/wiki/Kung_Fu_Panda_2',
         'https://en.wikipedia.org/wiki/Fast_Five',
         'https://en.wikipedia.org/wiki/The_Hangover_Part_II',
         'https://en.wikipedia.org/wiki/The_Smurfs_(film)',
         'https://en.wikipedia.org/wiki/Cars_2',
         'https://en.wikipedia.org/wiki/Toy_Story_3',
         'https://en.wikipedia.org/wiki/Alice_in_Wonderland_(2010_film)',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Deathly_Hallows_-_Part_1',
         'https://en.wikipedia.org/wiki/Inception',
         'https://en.wikipedia.org/wiki/Shrek_Forever_After',
         'https://en.wikipedia.org/wiki/The_Twilight_Saga:_Eclipse',
         'https://en.wikipedia.org/wiki/Iron_Man_2',
         'https://en.wikipedia.org/wiki/Tangled',
         'https://en.wikipedia.org/wiki/Despicable_Me',
         'https://en.wikipedia.org/wiki/How_to_Train_Your_Dragon_(film)',
         'https://en.wikipedia.org/wiki/Avatar_(2009_film)',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Half-Blood_Prince_(film)',
         'https://en.wikipedia.org/wiki/Ice_Age:_Dawn_of_the_Dinosaurs',
         'https://en.wikipedia.org/wiki/Transformers:_Revenge_of_the_Fallen',
         'https://en.wikipedia.org/wiki/2012_(film)',
         'https://en.wikipedia.org/wiki/Up_(2009_film)',
         'https://en.wikipedia.org/wiki/The_Twilight_Saga:_New_Moon',
         'https://en.wikipedia.org/wiki/Sherlock_Holmes_(2009_film)',
         'https://en.wikipedia.org/wiki/Angels_%26_Demons_(film)',
         'https://en.wikipedia.org/wiki/The_Hangover',
         'https://en.wikipedia.org/wiki/The_Dark_Knight_(film)',
         'https://en.wikipedia.org/wiki/Indiana_Jones_and_the_Kingdom_of_the_Crystal_Skull',
         'https://en.wikipedia.org/wiki/Kung_Fu_Panda',
         'https://en.wikipedia.org/wiki/Hancock_(film)',
         'https://en.wikipedia.org/wiki/Mamma_Mia!_(film)',
         'https://en.wikipedia.org/wiki/Madagascar:_Escape_2_Africa',
         'https://en.wikipedia.org/wiki/Quantum_of_Solace',
         'https://en.wikipedia.org/wiki/Iron_Man_(2008_film)',
         'https://en.wikipedia.org/wiki/WALL-E',
         'https://en.wikipedia.org/wiki/The_Chronicles_of_Narnia:_Prince_Caspian',
         'https://en.wikipedia.org/wiki/Pirates_of_the_Caribbean:_At_World%27s_End',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Order_of_the_Phoenix_(film)',
         'https://en.wikipedia.org/wiki/Spider-Man_3',
         'https://en.wikipedia.org/wiki/Shrek_the_Third',
         'https://en.wikipedia.org/wiki/Transformers_(film)',
         'https://en.wikipedia.org/wiki/Ratatouille_(film)',
         'https://en.wikipedia.org/wiki/I_Am_Legend_(film)',
         'https://en.wikipedia.org/wiki/The_Simpsons_Movie',
         'https://en.wikipedia.org/wiki/National_Treasure:_Book_of_Secrets',
         'https://en.wikipedia.org/wiki/300_(film)',
         'https://en.wikipedia.org/wiki/Pirates_of_the_Caribbean:_Dead_Man%27s_Chest',
         'https://en.wikipedia.org/wiki/The_Da_Vinci_Code_(film)',
         'https://en.wikipedia.org/wiki/Ice_Age:_The_Meltdown',
         'https://en.wikipedia.org/wiki/Casino_Royale_(2006_film)',
         'https://en.wikipedia.org/wiki/Night_at_the_Museum',
         'https://en.wikipedia.org/wiki/Cars_(film)',
         'https://en.wikipedia.org/wiki/X-Men:_The_Last_Stand',
         'https://en.wikipedia.org/wiki/Mission:_Impossible_III',
         'https://en.wikipedia.org/wiki/Superman_Returns',
         'https://en.wikipedia.org/wiki/Happy_Feet',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Goblet_of_Fire_(film)',
         'https://en.wikipedia.org/wiki/Star_Wars:_Episode_III_%E2%80%93_Revenge_of_the_Sith',
         'https://en.wikipedia.org/wiki/The_Chronicles_of_Narnia:_The_Lion,_the_Witch_and_the_Wardrobe',
         'https://en.wikipedia.org/wiki/War_of_the_Worlds_(2005_film)',
         'https://en.wikipedia.org/wiki/King_Kong_(2005_film)',
         'https://en.wikipedia.org/wiki/Madagascar_(2005_film)',
         'https://en.wikipedia.org/wiki/Mr._%26_Mrs._Smith_(2005_film)',
         'https://en.wikipedia.org/wiki/Charlie_and_the_Chocolate_Factory_(film)',
         'https://en.wikipedia.org/wiki/Batman_Begins',
         'https://en.wikipedia.org/wiki/Hitch_(film)',
         'https://en.wikipedia.org/wiki/Shrek_2',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Prisoner_of_Azkaban_(film)',
         'https://en.wikipedia.org/wiki/Spider-Man_2',
         'https://en.wikipedia.org/wiki/The_Incredibles',
         'https://en.wikipedia.org/wiki/The_Passion_of_the_Christ',
         'https://en.wikipedia.org/wiki/The_Day_After_Tomorrow',
         'https://en.wikipedia.org/wiki/Meet_the_Fockers',
         'https://en.wikipedia.org/wiki/Troy_(film)',
         'https://en.wikipedia.org/wiki/Shark_Tale',
         'https://en.wikipedia.org/wiki/Ocean%27s_Twelve',
         'https://en.wikipedia.org/wiki/The_Lord_of_the_Rings:_The_Return_of_the_King',
         'https://en.wikipedia.org/wiki/Finding_Nemo',
         'https://en.wikipedia.org/wiki/The_Matrix_Reloaded',
         'https://en.wikipedia.org/wiki/Pirates_of_the_Caribbean:_The_Curse_of_the_Black_Pearl',
         'https://en.wikipedia.org/wiki/Bruce_Almighty',
         'https://en.wikipedia.org/wiki/The_Last_Samurai',
         'https://en.wikipedia.org/wiki/Terminator_3:_Rise_of_the_Machines',
         'https://en.wikipedia.org/wiki/The_Matrix_Revolutions',
         'https://en.wikipedia.org/wiki/X2_(film)',
         'https://en.wikipedia.org/wiki/Bad_Boys_II',
         'https://en.wikipedia.org/wiki/The_Lord_of_the_Rings:_The_Two_Towers',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Chamber_of_Secrets_(film)',
         'https://en.wikipedia.org/wiki/Spider-Man_(2002_film)',
         'https://en.wikipedia.org/wiki/Star_Wars:_Episode_II_%E2%80%93_Attack_of_the_Clones',
         'https://en.wikipedia.org/wiki/Men_in_Black_II',
         'https://en.wikipedia.org/wiki/Die_Another_Day',
         'https://en.wikipedia.org/wiki/Signs_(film)',
         'https://en.wikipedia.org/wiki/Ice_Age_(2002_film)',
         'https://en.wikipedia.org/wiki/My_Big_Fat_Greek_Wedding',
         'https://en.wikipedia.org/wiki/Minority_Report_(film)',
         'https://en.wikipedia.org/wiki/Harry_Potter_and_the_Philosopher%27s_Stone_(film)',
         'https://en.wikipedia.org/wiki/The_Lord_of_the_Rings:_The_Fellowship_of_the_Ring',
         'https://en.wikipedia.org/wiki/Monsters,_Inc.',
         'https://en.wikipedia.org/wiki/Shrek',
         'https://en.wikipedia.org/wiki/Ocean%27s_Eleven',
         'https://en.wikipedia.org/wiki/Pearl_Harbor_(film)',
         'https://en.wikipedia.org/wiki/The_Mummy_Returns',
         'https://en.wikipedia.org/wiki/Jurassic_Park_III',
         'https://en.wikipedia.org/wiki/Planet_of_the_Apes_(2001_film)',
         'https://en.wikipedia.org/wiki/Hannibal_(2001_film)',
         'https://en.wikipedia.org/wiki/Mission:_Impossible_2',
         'https://en.wikipedia.org/wiki/Gladiator_(2000_film)',
         'https://en.wikipedia.org/wiki/Cast_Away',
         'https://en.wikipedia.org/wiki/What_Women_Want',
         'https://en.wikipedia.org/wiki/Dinosaur_(film)',
         'https://en.wikipedia.org/wiki/How_the_Grinch_Stole_Christmas_(2000_film)',
         'https://en.wikipedia.org/wiki/Meet_the_Parents',
         'https://en.wikipedia.org/wiki/The_Perfect_Storm_(film)',
         'https://en.wikipedia.org/wiki/X-Men_(film)',
         'https://en.wikipedia.org/wiki/What_Lies_Beneath')

for(i in 1:length(urls)){
  temp = scrap(urls[i])
  data = rbind(data,temp)
}

data = data %>% mutate(judul = as.character(judul),
                       sutradara = as.character(sutradara),
                       sutradara = gsub('[a]','',sutradara,fixed=T),
                       aktors = as.character(aktors))

str(data)
```

Berapa banyak film yang saya dapatkan?

```{r,echo=FALSE,warning=FALSE,message=FALSE}
length(unique(data$judul))
```


```{r,echo=FALSE,warning=FALSE,message=FALSE}
final = data.frame(from = data$sutradara,
                   to = data$aktors)
final = distinct(final)

final = 
final %>% mutate(panjang = stringr::str_length(to)) %>%
  filter(panjang < 25) %>% select(from,to)

graph_from_data_frame(final) %>%
  ggraph(layout = 'fr') +
  geom_edge_link(color='darkred',alpha=.4) +
  geom_node_point(size=2,color='steelblue') +
  geom_node_text(aes(label=name),size=2,alpha=.3) +
  theme_void()
ggsave('cobian.png',width = 8, height = 7,dpi=700)
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(dils)

final$id=1
tes = AdjacencyFromEdgelist(final)
hasil = tes$adjacency
colnames(hasil) = tes$nodelist
rownames(hasil) = tes$nodelist

library(sna)
close = sna::closeness(hasil)
between = sna::betweenness(hasil)
degree = sna::degree(hasil)

analisa.hasil = data.frame(nama=tes$nodelist,
                           close,
                           between,
                           degree)

analisa.hasil %>% filter(degree > 10) %>% arrange(desc(degree))

g = graph.adjacency(hasil,weighted = T, mode='undirected')
g = simplify(g)

set.seed(3952)
layout1 = layout.fruchterman.reingold(g)
png('between.png',width = 1024,height = 768,units = 'px');plot(g, layout=layout1,edge.curved=0.1,vertex.label.cex=0.5,vertex.size=between/2);dev.off()


fc = fastgreedy.community(as.undirected(g))
analisa.hasil$member = membership(fc)
```
