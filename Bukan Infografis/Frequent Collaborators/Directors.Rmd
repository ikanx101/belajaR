---
title: "Frequent Collaborators In Movies"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
setwd("/cloud/project/Bukan Infografis/Frequent Collaborators")
```

Percaya atau tidak, dalam bekerja biasanya kita memilih rekan kerja yang memang kita nyaman bekerja dengannya. Hal ini berlaku untuk semua bidang pekerjaan. Sama halnya saat para sutradara terbaik dunia dalam membuat film, ternyata ada beberapa aktor atau aktris yang menjadi __langganan__ mereka untuk bekerja sama.

Terinspirasi dari [__Six Degree of Kevin Bacon__](https://en.m.wikipedia.org/wiki/Six_Degrees_of_Kevin_Bacon), saya iseng akan membuat aktor atau aktris siapa yang memiliki koneksi kerjasama banyak dengan sutradara-sutradara tersebut.

Saya akan mengambil data detail dari __Wikipedia__ terkait 10 film dengan _highest grossing_ dari tahun 2000 - 2019.

Contohnya, pada film [Spider-Man: Far From Home](https://en.wikipedia.org/wiki/Spider-Man:_Far_From_Home), data hasil _scrap_-nya seperti ini:


```{r,include=FALSE}
library(dplyr)
library(ggplot2)
library(ggpubr)
library(ggraph)
library(igraph)
```

```{r,echo=FALSE}
load('hasil.rda')
data %>% filter(grepl('far from',judul,ignore.case = T))
```



```{r,echo=FALSE,warning=FALSE,message=FALSE}


str(data)
```

Berapa banyak film yang saya dapatkan?

```{r,echo=FALSE,warning=FALSE,message=FALSE}
length(unique(data$judul))
```

Kalau kita buat _network diagram_-nya, kita dapatkan bentuk seperti [ini](https://github.com/ikanx101/belajaR/raw/master/Bukan%20Infografis/Frequent%20Collaborators/cobian.png):

```{r,echo=FALSE,warning=FALSE,message=FALSE}
final = data.frame(from = data$sutradara,
                   to = data$aktors)
final = distinct(final)

final = 
final %>% mutate(panjang = stringr::str_length(to)) %>%
  filter(panjang < 25) %>% select(from,to)

graph_from_data_frame(final) %>%
  ggraph(layout = 'fr') +
  geom_edge_link(color='darkred',alpha=.4) +
  geom_node_point(size=2,color='steelblue') +
  geom_node_text(aes(label=name),size=2,alpha=.3) +
  theme_void()
ggsave('cobian.png',width = 12, height = 8,dpi=700)
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(dils)

final$id=1
tes = AdjacencyFromEdgelist(final)
hasil = tes$adjacency
colnames(hasil) = tes$nodelist
rownames(hasil) = tes$nodelist

library(sna)
close = sna::closeness(hasil)
between = sna::betweenness(hasil)
degree = sna::degree(hasil)

analisa.hasil = data.frame(nama=tes$nodelist,
                           close,
                           between,
                           degree)

analisa.hasil %>% filter(degree > 10) %>% arrange(desc(degree))

g = graph.adjacency(hasil,weighted = T, mode='undirected')
g = simplify(g)

set.seed(3952)
layout1 = layout.fruchterman.reingold(g)
png('between.png',width = 1024,height = 768,units = 'px');plot(g, layout=layout1,edge.curved=0.1,vertex.label.cex=0.5,vertex.size=between/2);dev.off()


fc = fastgreedy.community(as.undirected(g))
analisa.hasil$member = membership(fc)
```
