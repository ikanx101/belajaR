---
title: "Family Trip To Jogjakarta"
output: github_document
---

```{r,echo=FALSE,warning=FALSE,message=FALSE}
setwd("/cloud/project/Bukan Infografis/Family Trip Jogja")
rm(list=ls())
library(dplyr)
library(tidyr)
library(leaflet)
library(ggplot2)
```
# 2017

Di pertengahan 2017, saya dan nyonya berencana untuk melakukan _family trip_ pertama yang __jauh__. Mengajak serta Si Sulung yang kala itu masih TK dan Si Bungsu yang baru 2 tahun. 

> Sejauh apa? Hanya ke Jogjakarta.

Tiket pesawat sudah dibeli, Garuda Indonesia (pp). _Voucher_ hotel sudah sudah ada. Tinggal menunggu berangkat saja.

_Qodarullah_, 2 hari sebelum berangkat Si Bungsu demam. Tidak ingin mengambil resiko, akhirnya perjalanan tersebut kami batalkan. _Alhamdulillah_ semua tiket dan _voucher_ bisa di-_refund_ walau ada potongan sana-sini.

# 2019

Pada __Harbolnas__ 12.12 kemarin, nyonya melihat ada diskon pembelian _voucher_ hotel di aplikasi __Traveloka__. Seketika saja, kami putuskan untuk kembali menyelesaikan apa yang dulu pernah mau dilaksanakan: _family trip to Jogjakarta_. Bedanya, kali ini kami akan melakukannya melalui perjalanan darat. _InsyaAllah_ saya akan menyetir dari rumah ke Jogjakarta. _Trip_-nya sendiri akan dilakukan pasca liburan tahun baru.

> Jadi saat orang-orang baru selesai liburan tahun baru dan mulai beraktivitas normal, kami baru liburan. _Hehehehe_

Seperti perjalanan kemarin ke Malaysia, nyonya segera membuat _trip itinerary_ di sana. Beberapa tempat sudah masuk ke dalam daftar kunjung kami.

Nah, sebagai suami yang baik, saya akan mencoba membantu nyonya untuk mengurutkan tempat mana yang harus dikunjungi terlebih dahulu. Prinsipnya menggunakan __algoritma TSP__ seperti yang pernah saya [_post_ beberapa waktu lalu](https://passingthroughresearcher.wordpress.com/2019/11/18/menentukan-rute-jalan-jalan-paling-optimal-dengan-tsp/).

___

# Membuat Rute Jalan-Jalan yang Optimal

Berhubung nanti saya yang akan menyetir ke sana-sini, maka penting bagi saya untuk menemukan rute yang paling optimal, yakni jarak terpendek agar kaki gak keriting _nginjek-nginjek_ kopling (berhubung si __Magma Grey__ belum tiba di rumah, maka si __Putih__ yang akan jalan).

Selain itu, _trip_ ini juga harus banyak mengunjungi destinasi wisata. Berhubung _trip_ kali ini tidak bisa lama-lama karena Si Sulung sudah masuk sekolah (walaupun pada akhirnya dia bolos di hari-hari pertama masuk semester dua ini).

Oh iya, setelah berangkat malam dari rumah, kami berencana untuk menikmati sarapan Nasi Jamblang di Cirebon.

Berikut adalah beberapa destinasi wisata yang ingin dikunjungi:

```{r,echo=FALSE}
wisata = c('Nasi Jamblang Ibu Nur Cirebon',
           'Jejamuran Resto',
           'HeHa Sky View',
           'Sate Klathak Pak Pong',
           'Pantai Kukup',
           'Ayam Goreng Tojoyo Jalan Mayjend Sutoyo',
           'Museum Ullen Sentalu',
           'Taman Wisata Kaliurang',
           'Keraton Jogjakarta',
           'Taman Pintar Jogjakarta',
           'Jalan Malioboro',
           'Pasar Beringharjo',
           'Bakmi Mbah Gito')

hotel = c('Royal Ambarukmo Hotel',
          'The Alana Yogyakarta Hotel & Convention Center',
          'Bluebell Residence Sumarekon Bekasi')
wisata
load("destinasi.rda")
```

![peta](https://raw.githubusercontent.com/ikanx101/belajaR/master/Bukan%20Infografis/Family%20Trip%20Jogja/Peta%20Awal.png)

Dari lokasi-lokasi tersebut saya akan mencari titik __long-lat__-nya. Gunanya apa? Untuk mencari _distance matrix_.

## Mencari _Distance Matrix_

Untuk mencari rutenya, saya akan menggunakan algoritma _Travelling Salesperson Problem_ (__TSP__). Oleh karena itu, saya memerlukan _distance matrix_. Untuk mendapatkannya, saya akan menggunakan `library(ggmap)` di __R__ yang bisa menghitung jarak _real_ berdasarkan _Google Maps_.

```{r,echo=FALSE}
load('matrix jarak.rda')
distances = as.matrix(jarak) / 1000
colnames(distances) = destinasi$id
rownames(distances) = destinasi$id
distances
```

Distance matrix yang didapatkan tentunya tidak akan simetris. Karena jarak antara titik A ke B bisa jadi tidak sama dengan jarak antara titik B ke A. Kenapa? 

> Misalkan ada aturan jalan satu arah, dsb.

## Menghitung Jarak Terpendek dengan _TSP_

Sekarang kita akan hitung jarak terpendek dari _matrix_ tersebut dengan algoritma __TSP__. Didapatkan metode yang berhasil mendapatkan rute yang paling pendek adalah `arbitrary_insertion+two_opt` dengan jarak total sebesar `1.234,958` km

```{r,echo=FALSE}
load('hasil TSP.rda')
tour
```

Berikut adalah urutan perjalanan yang harus kami tempuh:

![peta 2](https://raw.githubusercontent.com/ikanx101/belajaR/master/Bukan%20Infografis/Family%20Trip%20Jogja/hasil%20tsp%201.png)

```{r,echo=FALSE}
addresses %>% select(alamat,lat,long)
```

____

## Fine Tuning the Algoritm

Oke, sekarang kami sudah punya urutan paling optimal yang melewati semua titik destinasi termasuk rumah dan hotel yang akan diinapi. Tapi, urutan ini masih belum realistis. Kenapa?

1. Kami akan menginap di dua hotel yang berbeda. Pada malam pertama dan kedua, kami akan menginap di Royal Ambarukmo. Sedangkan di malam terakhir kami akan menginap di Hotel Alana.
2. Kami berencana untuk membagi destinasi menjadi 3 hari dan di hari terakhir hanya pulang saja.

Oleh karena itu, algoritma __TSP__ harus dimodifikasi. Sebetulnya bukan algoritmanya yang harus dimodifikasi, tapi matrix jaraknya saja.


