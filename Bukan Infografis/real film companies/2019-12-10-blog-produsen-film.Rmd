---
title: "Movie Production Companies: a Clustering Story"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Dalam beberapa waktu ini, saya sedang sering melihat data terkait film yang dihimpun di situs [__the-numbers__](https://www.the-numbers.com/movies/production-companies/). 

> __"Sepertinya ada beberapa topik yang bisa dijadikan tulisan di blog"__, Pikir saya.

# Data __Movie Production Companies__

```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(rvest)
library(dplyr)
library(tidyr)
library(tidytext)
library(ggplot2)
library(ggthemes)
library(ggpubr)
library(ggrepel)
library(factoextra)

load('film.rda')
data = data %>% janitor::clean_names()
```
Dari _web_ tersebut, kita mendapatkan data `12.891` _movie production companies_ yang tersebar di seluruh dunia.

```{r}
head(data,10)
str(data)
```

Variabel yang didapatkan antara lain:

1. `production_companies`: nama perusahaan produsen film.
2. `no_of_movies`: banyaknya film yang diproduksi.
3. `total_domestic_box_office`: pendapatan film di pasar domestik.
4. `total_worldwide_box_office`: pendapatan film total _worldwide_.

```{r,echo=FALSE,warning=FALSE,message=FALSE}
data = data %>% mutate(total_domestic_box_office = gsub('\\,','',total_domestic_box_office),
                       total_domestic_box_office = gsub('\\$','',total_domestic_box_office),
                       total_worldwide_box_office = gsub('\\,','',total_worldwide_box_office),
                       total_worldwide_box_office = gsub('\\$','',total_worldwide_box_office),
                       total_domestic_box_office = as.numeric(total_domestic_box_office),
                       total_worldwide_box_office = as.numeric(total_worldwide_box_office))

new_data = data %>% mutate(no_of_movies = cut(no_of_movies,10,labels = c(1:10)),
                           total_domestic_box_office = cut(total_domestic_box_office,10,
                                                       labels = c(1:10)),
                           total_worldwide_box_office = cut(total_worldwide_box_office,10,
                                                        labels = c(1:10)))
```

Sekarang, mari kita buat _scatter plot_ dari data tersebut yah. Sumbu `x` akan saya isi dengan `no_of_movies` dan sumbu `y` akan saya isi dengan `total_worldwide_box_office`, sementara _size_ dari _point_ tergantung dari besarnya `total_domestic_box_office`.

## _Scatter plot_ dari data

```{r,echo=FALSE}
data %>% ggplot(aes(x=no_of_movies,y=total_worldwide_box_office)) +
  geom_point(aes(size=total_domestic_box_office),
             color='steelblue',
             alpha=.4) +
  scale_size(range = c(0, 10)) +
  geom_text(aes(label=production_companies),size=2.5,alpha=.8) +
  theme_minimal() +
  geom_vline(xintercept = mean(data$no_of_movies),color='darkred') +
  geom_hline(yintercept = mean(data$total_worldwide_box_office),color='darkred') +
  theme(legend.position = 'none',
        axis.text = element_blank()) +
  labs(title = 'Number of Movies vs Total Worldwide Box Office',
       subtitle = 'source: the-numbers.com',
       caption = 'Scraped and Visualized\nusing R\nikanx101.github.io',
       x = 'Number of movies',
       y = 'Total Worldwide Box Office') +
  theme(plot.title = element_text(face='bold.italic'),
        plot.subtitle = element_text(face='bold'),
        plot.caption = element_text(face='italic',size = 8)) 
```

_Gimana?_ sudah terlihat `production_companies` favorit kamu?

## _Clustering Analysis_ dari data

Sekarang kita akan mencoba mengelompokkan `production_companies` dari data-data yang ada. Saya akan menggunakan algoritma __k-means clustering__. 

> Contoh lain penggunaan k-means clustering sudah pernah saya tulis di [blog saya yang lama](https://passingthroughresearcher.wordpress.com/2019/11/24/clustering-negara-berdasarkan-gdp-happiness-index-dan-populasi/).

Agar memudahkan, angka real dari masing-masing variabel `no_of_movies`, `total_domestic_box_office`, dan `total_worldwide_box_office` akan saya buat dalam rentang 1-10 dengan fungsi `cut()` di __R__.

```{r,echo=FALSE}
new_data = new_data %>% select(-production_companies)
fviz_nbclust(new_data, kmeans, method = "wss")
```

Tess