---
title: "Upah Minimum Kota di Pulau Jawa"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
setwd("/cloud/project/Bukan Infografis/Upah Minimum Kota")
library(rvest)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(tidytext)
```

Sebagai seorang orang yang berkecimpung di dunia _recruitment_ dan _HR_, nyonya malam ini mengajak diskusi terkait dengan data hasil survey mengenai __Indonesia Salary Benchmark__ yang dilakukan oleh lembaga bernama _Michael Page_.

> _Seharusnya gaji kamu itu segini lho..._ Katanya sambil menunjuk ke hasil surveynya.

> _Oh begitu yah?_ Jawab saya sambil tersenyum.

Persoalan mengenai gaji memang tiada habisnya. Dari level yang tinggi sampai yang paling bawah. Terlebih lagi saat kita membahas masalah __Upah Minimum Provinsi atau Kota__ yang ada di Pulau Jawa. Masing-masing provinsi dan kota memiliki cara perhitungan masing-masing sehingga besarannya juga berbeda.

Ada yang masih menjadi polemik, ada yang tenang-tenang saja dan minim pemberitaan.

Penasaran dengan besaran UMK tersebut, saya coba _Googling_ sana-sini untuk mendapatkan datanya.

> _Kalau nemu dalam bentuk tabel, enak banget nih scrap-nya_ Pikir saya.

Tapi setelah mencari-cari kok tidak ketemu yah.

Akhirnya saya putuskan untuk mengambil datanya dari teks di [halaman berita ini](https://www.kompas.com/tren/read/2019/11/22/191520565/disahkan-berikut-rincian-ump-dan-umk-2020-di-dki-jakarta-jawa-barat-jawa?page=all).

## Scrap data

Saya mulai dengan scrap data menggunakan `library(rvest)` di __R__. Tapi sayang sekali, formatnya masih _unstructured_ sebagai berikut:

```{r,echo=FALSE}
url = 'https://www.kompas.com/tren/read/2019/11/22/191520565/disahkan-berikut-rincian-ump-dan-umk-2020-di-dki-jakarta-jawa-barat-jawa?page=all'

data = read_html(url) %>% html_nodes('.read__content li') %>% html_text()
data[101] = "DKI Jakarta Rp 4.267.349"
head(data,15)
```

## Data carpentry

Bentuk data itu harus saya ubah dulu agar bisa dianalisa lebih lanjut. Sebenarnya caranya simpel yah, jika diperhatikan baik - baik, saya bisa melakukan `separate` dengan memanfaatkan pola adanya tanda __Rp__ di setiap baris data.

Setelah itu, saya akan tambahkan informasi mengenai nama provinsi sebagai variabel. Sehingga didapatkan data sebagai berikut:

```{r,echo=FALSE}
data = data.frame(isi=data,id=c(1:length(data)))
data=
  data %>%
  mutate(isi = gsub('\\.','',isi),
         isi = gsub('\\:','',isi)) %>%
  separate(isi,into=c('kota_kab','umk'),sep='Rp') %>%
  mutate(umk = gsub(' ','',umk),
         provinsi = 'a', tipe='b') %>%
  select(provinsi,tipe,kota_kab,umk)
data$provinsi[1:27] = 'Jawa Barat'
data$provinsi[28:62] = 'Jawa Tengah'
data$provinsi[63:100] = 'Jawa Timur'
data$provinsi[101] = 'DKI Jakarta'
data$tipe = ifelse(grepl('kota',data$kota_kab,ignore.case = T),'Kota','Kabupaten')
data$tipe[101] = 'DKI'
data$umk = as.numeric(data$umk)
head(data,15)
```

## Mulai oprek-oprek

Nah, berhubung datanya sudah rapih, mari kita lihat satu-persatu yah.

### Kota vs Kabupaten

Banyak orang (termasuk saya) tidak bisa membedakan apa itu kota dan kabupaten. Apakah kota selalu lebih maju dibanding kabupaten? Untuk urusan upah minimum ini, mari kita lihat perbandingan kota dan kabupaten di Jawa Barat, Jawa Tengah, dan Jawa Timur.

```{r}
data %>% filter(tipe!='DKI') %>% group_by(tipe) %>%
  summarise(mean_umk=mean(umk),
            std_umk=sd(umk),
            n=n())
```

```{r,echo=FALSE}
data %>% filter(tipe!='DKI') %>% group_by(tipe) %>%
  summarise(rata=mean(umk),stdev=sd(umk)) %>%
  ggplot(aes(x=tipe,y=rata)) + geom_col(color='steelblue',fill='white',alpha=.4) +
  geom_errorbar(aes(ymin=rata-stdev, ymax=rata+stdev), width=.2,color='darkgreen') +
  geom_label(aes(label=paste(round(rata/1000000,1),'juta'))) +
  theme_pubclean() +
  labs(title = 'Upah Minimum Kota vs Kabupaten 2020',
       subtitle = 'Jawa Barat, Jawa Tengah, dan Jawa Timur',
       caption = 'ikanx.github.io') +
  theme(axis.text.y = element_blank(),
        axis.title = element_blank(),
        plot.title = element_text(size=25,face='bold.italic'))
```

Dari informasi dan grafik di atas, kita bisa menyimpulkan sementara bahwa upah minimum di kota lebih tinggi dibandingkan kabupaten. Apakah perbedaan ini signifikan? Untuk mengeceknya, kita akan lakukan uji t (_t test_).

> Tapi ingat ya, bahwa _t test_ itu digunakan pada statistika parametrik!

Untuk data UMK ini, berhubung saya malas untuk mengecek normalitasnya, maka saya akan gunakan uji non parametrik pengganti _t test_ yakni __Wilcoxon test (rank sum test)__.

Sebagai informasi, statistika non parametrik adalah analisa statistika yang tidak memperdulikan distribusi dari suatu data yang akan diuji.

Untuk menyelesaikannya, saya akan membuat hipotesis berikut:

1. H0: `umk` di kota dan kabupaten tidak berbeda signifikan.
2. H1: `umk` di kota dan kabupaten berbeda signifikan.

Mari kita uji hipotesis tersebÃ¹t dengan __Wilcoxon test__.

```{r,echo=FALSE}
my_data = data %>% filter(tipe!='DKI')
stat_uji = wilcox.test(umk ~ tipe, 
                       data = my_data,
                       exact = FALSE)
stat_uji
```

Dari hasil uji di atas, kita akan melihat berapa nilai __p-value__ yang didapatkan, yakni:

```{r,echo=FALSE}
stat_uji$p.value
```

Kita akan bandingkan nilai __p-value__ tersebut dengan alpha=0.05.

> Karena __p-value__ lebih kecil dari alpha, maka H0 ditolak.

Kita bisa menyimpulkan bahwa ada perbedaan nilai rata-rata `umk` di kota dan kabupaten pada data ini.

```{r}

```